<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Alpine + TypeScript Demo</title>
    <script
      type="module"
      src="./src/main.ts"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  </head>

  <body class="bg-gray-100 text-gray-800">
    <main class="max-w-4xl mx-auto p-8">
      <!-- Header -->
      <div class="flex justify-between items-center mb-8">
        <h1 class="text-3xl font-bold tracking-tight text-rose-700">
          Shop Beauty Picks
        </h1>
        <div
          class="relative"
          x-data="cart"
          @add-to-cart.window="count++">
          <button
            class="bg-white rounded-full p-2 shadow-sm hover:shadow-md transition border border-gray-200">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              class="text-rose-600">
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M5.79166 2H1V4H4.2184L6.9872 16.6776H7V17H20V16.7519L22.1932 7.09095L22.5308 6H6.6552L6.08485 3.38852L5.79166 2ZM19.9869 8H7.092L8.62081 15H18.3978L19.9869 8Z"
                fill="currentColor" />
              <path
                d="M10 22C11.1046 22 12 21.1046 12 20C12 18.8954 11.1046 18 10 18C8.89543 18 8 18.8954 8 20C8 21.1046 8.89543 22 10 22Z"
                fill="currentColor" />
              <path
                d="M19 20C19 21.1046 18.1046 22 17 22C15.8954 22 15 21.1046 15 20C15 18.8954 15.8954 18 17 18C18.1046 18 19 18.8954 19 20Z"
                fill="currentColor" />
            </svg>
          </button>
          <span
            class="absolute -top-1 -right-1 bg-rose-600 text-white text-xs font-semibold rounded-full px-1.5 py-0.5 shadow"
            x-text="count"></span>
        </div>
      </div>

      <!-- Product List -->
      <ul
        class="space-y-6"
        x-data="products">
        <template x-for="product in products">
          <li
            class="bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-md transition-shadow p-6"
            :key="product.id">
            <div class="flex gap-6">
              <div
                class="bg-gray-50 p-2 rounded-lg flex-shrink-0 flex items-center justify-center w-36">
                <img
                  :src="product.thumbnail"
                  :alt="product.title"
                  class="w-full object-contain h-full max-h-48" />
              </div>
              <div class="flex-1 flex flex-col justify-between">
                <div>
                  <div class="flex justify-between items-start mb-3">
                    <h2
                      class="text-xl font-semibold text-gray-900"
                      x-text="product.title"></h2>
                    <button
                      @click="$dispatch('open-modal', {reviews: product.reviews, productName: product.title})"
                      class="text-xs font-medium border border-rose-600 text-rose-600 bg-white px-3 py-1 rounded-full hover:bg-rose-50 transition shadow-sm">
                      Reviews (<span x-text="product.reviews.length"></span>)
                    </button>
                  </div>
                  <p
                    class="text-sm text-gray-600 mb-3"
                    x-text="product.description"></p>
                  <span class="text-base font-semibold text-gray-900"
                    >$<span x-text="product.price"></span
                  ></span>
                </div>
                <div class="mt-4 flex justify-end">
                  <button
                    @click="$dispatch('add-to-cart')"
                    class="text-sm font-medium bg-rose-600 text-white px-4 py-2 rounded-full hover:bg-rose-700 transition shadow-sm">
                    Add to Cart
                  </button>
                </div>
              </div>
            </div>
          </li>
        </template>
      </ul>
    </main>

    <!-- Modal -->
    <div
      x-data="modal"
      @open-modal.window="launchModal($event)"
      :class="!open ? 'hidden' : ''"
      class="fixed inset-0 bg-black/60 flex items-center justify-center z-50"
      id="product-review-modal">
      <div class="bg-white rounded-xl shadow-lg max-w-xl w-full p-6 relative">
        <!-- Header -->
        <div class="flex justify-between items-start mb-6">
          <div>
            <h3 class="text-xl font-semibold text-gray-900">Reviews for:</h3>
            <p
              class="text-lg font-medium text-rose-700 leading-tight"
              x-text="productName"></p>
          </div>
          <button
            @click="open = false"
            class="text-gray-400 hover:text-rose-500 text-xl font-bold"
            aria-label="Close">
            &times;
          </button>
        </div>

        <!-- Reviews -->
        <ul class="space-y-4 max-h-80 overflow-y-auto pr-1">
          <template x-for="review in reviews">
            <li
              class="flex items-start gap-4 border border-gray-100 rounded-lg p-4 bg-gray-50 shadow-sm">
              <img
                :src="`https://api.dicebear.com/7.x/croodles/svg?seed=${review.reviewerName}`"
                :alt="`${review.reviewerName} Avatar`"
                class="w-10 h-10 rounded-full bg-white border border-gray-200 flex-shrink-0" />
              <div>
                <p
                  class="text-sm italic text-gray-800"
                  x-text="review.comment"></p>
                <p class="text-xs text-gray-500 mt-1">
                  â€” <span x-text="review.reviewerName"></span>
                </p>
              </div>
            </li>
          </template>
        </ul>

        <!-- Footer -->
        <div class="mt-6 flex justify-end">
          <button
            @click="open = false"
            class="px-4 py-2 text-sm font-medium bg-rose-600 text-white rounded-full hover:bg-rose-700 transition shadow-sm"
            aria-label="Dismiss">
            Close
          </button>
        </div>
      </div>
    </div>
  </body>
</html>
